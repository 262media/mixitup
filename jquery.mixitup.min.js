/*
* MIXITUP - A CSS3 and JQuery Filter & Sort Plugin
* Version: 1.5.2
* License: Creative Commons Attribution-NoDerivs 3.0 Unported - CC BY-ND 3.0
* http://creativecommons.org/licenses/by-nd/3.0/
* This software may be used freely on commercial and non-commercial projects with attribution to the author/copyright holder.
* Author: Patrick Kunka
* Copyright 2012-2013 Patrick Kunka, Barrel LLC, All Rights Reserved
* 
* http://mixitup.io
*/

(function(e){function v(d,a,g,c,b){function j(){k.unbind();a&&w(a,g,c,b);b.startOrder=[];b.newOrder=[];b.origSort=[];b.checkSort=[];p.removeStyle(b.prefix+"filter, filter, "+b.prefix+"transform, transform, opacity, display").css(b.clean).removeAttr("data-checksum");window.atob||p.css({display:"none",opacity:"0"});k.removeStyle(b.prefix+"transition, transition, "+b.prefix+"perspective, perspective, "+b.prefix+"perspective-origin, perspective-origin, "+(b.resizeContainer?"height":""));"list"==b.layoutMode?
(q.css({display:b.targetDisplayList,opacity:"1"}),b.origDisplay=b.targetDisplayList):(q.css({display:b.targetDisplayGrid,opacity:"1"}),b.origDisplay=b.targetDisplayGrid);b.origLayout=b.layoutMode;setTimeout(function(){p.removeStyle(b.prefix+"transition, transition");b.mixing=!1;if("function"==typeof b.onMixEnd){var a=b.onMixEnd.call(this,b);b=a?a:b}})}clearInterval(b.failsafe);b.mixing=!0;b.filter=d;if("function"==typeof b.onMixStart){var f=b.onMixStart.call(this,b);b=f?f:b}for(var h=b.transitionSpeed,
f=0;2>f;f++){var l=0==f?l=b.prefix:"";b.transition[l+"transition"]="all "+h+"ms linear";b.transition[l+"transform"]=l+"translate3d(0,0,0)";b.perspective[l+"perspective"]=b.perspectiveDistance+"px";b.perspective[l+"perspective-origin"]=b.perspectiveOrigin}var r=b.targetSelector,p=c.find(r);p.each(function(){this.data={}});var k=p.parent();k.css(b.perspective);b.easingFallback="ease-in-out";"smooth"==b.easing&&(b.easing="cubic-bezier(0.25, 0.46, 0.45, 0.94)");"snap"==b.easing&&(b.easing="cubic-bezier(0.77, 0, 0.175, 1)");
"windback"==b.easing&&(b.easing="cubic-bezier(0.175, 0.885, 0.320, 1.275)",b.easingFallback="cubic-bezier(0.175, 0.885, 0.320, 1)");"windup"==b.easing&&(b.easing="cubic-bezier(0.6, -0.28, 0.735, 0.045)",b.easingFallback="cubic-bezier(0.6, 0.28, 0.735, 0.045)");f="list"==b.layoutMode&&null!=b.listEffects?b.listEffects:b.effects;Array.prototype.indexOf&&(b.fade=-1<f.indexOf("fade")?"0":"",b.scale=-1<f.indexOf("scale")?"scale(.01)":"",b.rotateZ=-1<f.indexOf("rotateZ")?"rotate(180deg)":"",b.rotateY=-1<
f.indexOf("rotateY")?"rotateY(90deg)":"",b.rotateX=-1<f.indexOf("rotateX")?"rotateX(90deg)":"",b.blur=-1<f.indexOf("blur")?"blur(8px)":"",b.grayscale=-1<f.indexOf("grayscale")?"grayscale(100%)":"");d=d.replace(/\s|\//g,".");var q=e(),s=e(),t=d.split(".");e.each(t,function(b){"all"==this&&(t[b]="mix_all")});"or"==b.filterLogic?(b.multiFilter&&""==t[0]&&t.shift(),1>t.length?s=s.add(c.find(r+":visible")):p.each(function(){for(var b=0,a=e(this),c=0;c<t.length;c++)a.hasClass(t[c])&&(q=q.add(a),b++);0==
b&&(s=s.add(a))})):(q=q.add(k.find(r+"."+t.join("."))),s=s.add(k.find(r+":not(."+t.join(".")+"):visible")));d=q.length;var u=e(),n=e(),m=e();s.each(function(){var b=e(this);"none"!=b.css("display")&&(u=u.add(b),m=m.add(b))});if(q.filter(":visible").length==d&&!u.length&&!a){if(b.origLayout==b.layoutMode)return j(),!1;if(1==q.length)return"list"==b.layoutMode?(c.addClass(b.listClass),c.removeClass(b.gridClass),m.css("display",b.targetDisplayList)):(c.addClass(b.gridClass),c.removeClass(b.listClass),
m.css("display",b.targetDisplayGrid)),j(),!1}b.origHeight=k.height();if(q.length){c.removeClass(b.failClass);q.each(function(){var b=e(this);"none"==b.css("display")?n=n.add(b):m=m.add(b)});if(b.origLayout!=b.layoutMode&&!1==b.animateGridList)return"list"==b.layoutMode?(c.addClass(b.listClass),c.removeClass(b.gridClass),m.css("display",b.targetDisplayList)):(c.addClass(b.gridClass),c.removeClass(b.listClass),m.css("display",b.targetDisplayGrid)),j(),!1;if(!window.atob)return j(),!1;p.css(b.clean);
m.each(function(){this.data.origPos=e(this).offset()});"list"==b.layoutMode?(c.addClass(b.listClass),c.removeClass(b.gridClass),n.css("display",b.targetDisplayList)):(c.addClass(b.gridClass),c.removeClass(b.listClass),n.css("display",b.targetDisplayGrid));n.each(function(){this.data.showInterPos=e(this).offset()});u.each(function(){this.data.hideInterPos=e(this).offset()});m.each(function(){this.data.preInterPos=e(this).offset()});"list"==b.layoutMode?m.css("display",b.targetDisplayList):m.css("display",
b.targetDisplayGrid);a&&w(a,g,c,b);if(a&&b.origSort.compare(b.checkSort))return j(),!1;u.hide();n.each(function(){this.data.finalPos=e(this).offset()});m.each(function(){this.data.finalPrePos=e(this).offset()});b.newHeight=k.height();a&&w("reset",null,c,b);n.hide();m.css("display",b.origDisplay);"block"==b.origDisplay?(c.addClass(b.listClass),n.css("display",b.targetDisplayList)):(c.removeClass(b.listClass),n.css("display",b.targetDisplayGrid));b.resizeContainer&&k.css("height",b.origHeight+"px");
d={};for(f=0;2>f;f++)l=0==f?l=b.prefix:"",d[l+"transform"]=b.scale+" "+b.rotateX+" "+b.rotateY+" "+b.rotateZ,d[l+"filter"]=b.blur+" "+b.grayscale;n.css(d);m.each(function(){var a=this.data,c=e(this);c.hasClass("mix_tohide")?(a.preTX=a.origPos.left-a.hideInterPos.left,a.preTY=a.origPos.top-a.hideInterPos.top):(a.preTX=a.origPos.left-a.preInterPos.left,a.preTY=a.origPos.top-a.preInterPos.top);for(var d={},f=0;2>f;f++){var l=0==f?l=b.prefix:"";d[l+"transform"]="translate("+a.preTX+"px,"+a.preTY+"px)"}c.css(d)});
"list"==b.layoutMode?(c.addClass(b.listClass),c.removeClass(b.gridClass)):(c.addClass(b.gridClass),c.removeClass(b.listClass));setTimeout(function(){if(b.resizeContainer){for(var a={},c=0;2>c;c++){var d=0==c?d=b.prefix:"";a[d+"transition"]="all "+h+"ms ease-in-out";a.height=b.newHeight+"px"}k.css(a)}u.css("opacity",b.fade);n.css("opacity",1);n.each(function(){var a=this.data;a.tX=a.finalPos.left-a.showInterPos.left;a.tY=a.finalPos.top-a.showInterPos.top;for(var c={},d=0;2>d;d++){var f=0==d?f=b.prefix:
"";c[f+"transition-property"]=f+"transform, "+f+"filter, opacity";c[f+"transition-timing-function"]=b.easing+", linear, linear";c[f+"transition-duration"]=h+"ms";c[f+"transition-delay"]="0";c[f+"transform"]="translate("+a.tX+"px,"+a.tY+"px)";c[f+"filter"]="none"}e(this).css("-webkit-transition","all "+h+"ms "+b.easingFallback).css(c)});m.each(function(){var a=this.data;a.tX=0!=a.finalPrePos.left?a.finalPrePos.left-a.preInterPos.left:0;a.tY=0!=a.finalPrePos.left?a.finalPrePos.top-a.preInterPos.top:
0;for(var c={},d=0;2>d;d++){var f=0==d?f=b.prefix:"";c[f+"transition"]="all "+h+"ms "+b.easing;c[f+"transform"]="translate("+a.tX+"px,"+a.tY+"px)"}e(this).css("-webkit-transition","all "+h+"ms "+b.easingFallback).css(c)});a={};for(c=0;2>c;c++)d=0==c?d=b.prefix:"",a[d+"transition"]="all "+h+"ms "+b.easing+", "+d+"filter "+h+"ms linear, opacity "+h+"ms linear",a[d+"transform"]=b.scale+" "+b.rotateX+" "+b.rotateY+" "+b.rotateZ,a[d+"filter"]=b.blur+" "+b.grayscale,a.opacity=b.fade;u.css(a);k.bind("webkitTransitionEnd transitionend otransitionend oTransitionEnd",
function(a){if(-1<a.originalEvent.propertyName.indexOf("transform")||-1<a.originalEvent.propertyName.indexOf("opacity"))-1<r.indexOf(".")?e(a.target).hasClass(r.replace(".",""))&&j():e(a.target).is(r)&&j()})},10);b.failsafe=setTimeout(function(){b.mixing&&j()},h+400)}else{b.resizeContainer&&k.css("height",b.origHeight+"px");if(!window.atob)return j(),!1;u=s;setTimeout(function(){k.css(b.perspective);if(b.resizeContainer){for(var a={},d=0;2>d;d++){var e=0==d?e=b.prefix:"";a[e+"transition"]="height "+
h+"ms ease-in-out";a.height=b.minHeight+"px"}k.css(a)}p.css(b.transition);if(s.length){a={};for(d=0;2>d;d++)e=0==d?e=b.prefix:"",a[e+"transform"]=b.scale+" "+b.rotateX+" "+b.rotateY+" "+b.rotateZ,a[e+"filter"]=b.blur+" "+b.grayscale,a.opacity=b.fade;u.css(a);k.bind("webkitTransitionEnd transitionend otransitionend oTransitionEnd",function(a){if(-1<a.originalEvent.propertyName.indexOf("transform")||-1<a.originalEvent.propertyName.indexOf("opacity"))c.addClass(b.failClass),j()})}else b.mixing=!1},10)}}
function w(d,a,g,c){function b(a,b){var c=isNaN(1*a.attr(d))?a.attr(d).toLowerCase():1*a.attr(d),e=isNaN(1*b.attr(d))?b.attr(d).toLowerCase():1*b.attr(d);return c<e?-1:c>e?1:0}function j(b){"asc"==a?f.prepend(b).prepend(" "):f.append(b).append(" ")}g.find(c.targetSelector).wrapAll('<div class="mix_sorter"/>');var f=g.find(".mix_sorter");c.origSort.length||f.find(c.targetSelector+":visible").each(function(){e(this).wrap("<s/>");c.origSort.push(e(this).parent().html().replace(/\s+/g,""));e(this).unwrap()});
f.empty();if("reset"==d)e.each(c.startOrder,function(){f.append(this).append(" ")});else if("default"==d)e.each(c.origOrder,function(){j(this)});else if("random"==d){if(!c.newOrder.length){for(var h=c.startOrder.slice(),l=h.length,r=l;r--;){var p=parseInt(Math.random()*l),k=h[r];h[r]=h[p];h[p]=k}c.newOrder=h}e.each(c.newOrder,function(){f.append(this).append(" ")})}else if("custom"==d)e.each(a,function(){j(this)});else{if("undefined"===typeof c.origOrder[0].attr(d))return console.log("No such attribute found. Terminating"),
!1;c.newOrder.length||(e.each(c.origOrder,function(){c.newOrder.push(e(this))}),c.newOrder.sort(b));e.each(c.newOrder,function(){j(this)})}c.checkSort=[];f.find(c.targetSelector+":visible").each(function(a){var b=e(this);0==a&&b.attr("data-checksum","1");b.wrap("<s/>");c.checkSort.push(b.parent().html().replace(/\s+/g,""));b.unwrap()});g.find(c.targetSelector).unwrap()}var x={init:function(d){return this.each(function(){var a={targetSelector:".mix",filterSelector:".filter",sortSelector:".sort",buttonEvent:"click",
effects:["fade","scale"],listEffects:null,easing:"smooth",layoutMode:"grid",targetDisplayGrid:"inline-block",targetDisplayList:"block",listClass:"",gridClass:"",transitionSpeed:600,showOnLoad:"all",sortOnLoad:!1,multiFilter:!1,filterLogic:"or",resizeContainer:!0,minHeight:0,failClass:"fail",perspectiveDistance:"3000",perspectiveOrigin:"50% 50%",animateGridList:!0,onMixLoad:null,onMixStart:null,onMixEnd:null,container:null,origOrder:[],startOrder:[],newOrder:[],origSort:[],checkSort:[],filter:"",mixing:!1,
origDisplay:"",origLayout:"",origHeight:0,newHeight:0,isTouch:!1,resetDelay:0,failsafe:null,prefix:"",easingFallback:"ease-in-out",transition:{},perspective:{},clean:{},fade:"1",scale:"",rotateX:"",rotateY:"",rotateZ:"",blur:"",grayscale:""};d&&e.extend(a,d);this.config=a;e.support.touch="ontouchend"in document;e.support.touch&&(a.isTouch=!0,a.resetDelay=350);a.container=e(this);var g=a.container,c;a:{c=g[0];for(var b=["Webkit","Moz","O","ms"],j=0;j<b.length;j++)if(b[j]+"Transition"in c.style){c=
b[j];break a}c="transition"in c.style?"":!1}a.prefix=c;a.prefix=a.prefix?"-"+a.prefix.toLowerCase()+"-":"";g.find(a.targetSelector).each(function(){a.origOrder.push(e(this))});if(a.sortOnLoad){var f;e.isArray(a.sortOnLoad)?(c=a.sortOnLoad[0],f=a.sortOnLoad[1],e(a.sortSelector+"[data-sort="+a.sortOnLoad[0]+"][data-order="+a.sortOnLoad[1]+"]").addClass("active")):(e(a.sortSelector+"[data-sort="+a.sortOnLoad+"]").addClass("active"),c=a.sortOnLoad,a.sortOnLoad="desc");w(c,f,g,a)}for(f=0;2>f;f++)c=0==
f?c=a.prefix:"",a.transition[c+"transition"]="all "+a.transitionSpeed+"ms ease-in-out",a.perspective[c+"perspective"]=a.perspectiveDistance+"px",a.perspective[c+"perspective-origin"]=a.perspectiveOrigin;for(f=0;2>f;f++)c=0==f?c=a.prefix:"",a.clean[c+"transition"]="none";"list"==a.layoutMode?(g.addClass(a.listClass),a.origDisplay=a.targetDisplayList):(g.addClass(a.gridClass),a.origDisplay=a.targetDisplayGrid);a.origLayout=a.layoutMode;f=a.showOnLoad.split(" ");e.each(f,function(){e(a.filterSelector+
'[data-filter="'+this+'"]').addClass("active")});g.find(a.targetSelector).addClass("mix_all");"all"==f[0]&&(f[0]="mix_all",a.showOnLoad="mix_all");var h=e();e.each(f,function(){h=h.add(e("."+this))});h.each(function(){var b=e(this);"list"==a.layoutMode?b.css("display",a.targetDisplayList):b.css("display",a.targetDisplayGrid);b.css(a.transition)});setTimeout(function(){a.mixing=!0;h.css("opacity","1");setTimeout(function(){"list"==a.layoutMode?h.removeStyle(a.prefix+"transition, transition").css({display:a.targetDisplayList,
opacity:1}):h.removeStyle(a.prefix+"transition, transition").css({display:a.targetDisplayGrid,opacity:1});a.mixing=!1;if("function"==typeof a.onMixLoad){var b=a.onMixLoad.call(this,a);a=b?b:a}},a.transitionSpeed)},10);a.filter=a.showOnLoad;e(a.sortSelector).bind(a.buttonEvent,function(){if(!a.mixing){var b=e(this),c=b.attr("data-sort"),d=b.attr("data-order");if(b.hasClass("active")){if("random"!=c)return!1}else e(a.sortSelector).removeClass("active"),b.addClass("active");g.find(a.targetSelector).each(function(){a.startOrder.push(e(this))});
v(a.filter,c,d,g,a)}});e(a.filterSelector).bind(a.buttonEvent,function(){if(!a.mixing){var b=e(this);if(!1==a.multiFilter)e(a.filterSelector).removeClass("active"),b.addClass("active"),a.filter=b.attr("data-filter"),e(a.filterSelector+'[data-filter="'+a.filter+'"]').addClass("active");else{var c=b.attr("data-filter");"all"==c&&(c="mix_all");b.hasClass("active")?(b.removeClass("active"),a.filter=a.filter.replace(RegExp("(\\s|^)"+c),"")):(b.addClass("active"),a.filter=a.filter+" "+c)}v(a.filter,null,
null,g,a)}})})},toGrid:function(){return this.each(function(){var d=this.config;"grid"!=d.layoutMode&&(d.layoutMode="grid",v(d.filter,null,null,e(this),d))})},toList:function(){return this.each(function(){var d=this.config;"list"!=d.layoutMode&&(d.layoutMode="list",v(d.filter,null,null,e(this),d))})},filter:function(d){return this.each(function(){var a=this.config;a.mixing||(e(a.filterSelector).removeClass("active"),e(a.filterSelector+'[data-filter="'+d+'"]').addClass("active"),v(d,null,null,e(this),
a))})},sort:function(d){return this.each(function(){var a=this.config,g=e(this);if(!a.mixing){e(a.sortSelector).removeClass("active");if(e.isArray(d)){var c=d[0],b=d[1];e(a.sortSelector+'[data-sort="'+d[0]+'"][data-order="'+d[1]+'"]').addClass("active")}else e(a.sortSelector+'[data-sort="'+d+'"]').addClass("active"),c=d,b="desc";g.find(a.targetSelector).each(function(){a.startOrder.push(e(this))});v(a.filter,c,b,g,a)}})},multimix:function(d){return this.each(function(){var a=this.config,g=e(this);
multiOut={filter:a.filter,sort:null,order:"desc",layoutMode:a.layoutMode};e.extend(multiOut,d);a.mixing||(e(a.filterSelector).add(a.sortSelector).removeClass("active"),e(a.filterSelector+'[data-filter="'+multiOut.filter+'"]').addClass("active"),"undefined"!==typeof multiOut.sort&&(e(a.sortSelector+'[data-sort="'+multiOut.sort+'"][data-order="'+multiOut.order+'"]').addClass("active"),g.find(a.targetSelector).each(function(){a.startOrder.push(e(this))})),a.layoutMode=multiOut.layoutMode,v(multiOut.filter,
multiOut.sort,multiOut.order,g,a))})},remix:function(d){return this.each(function(){var a=this.config,g=e(this);a.origOrder=[];g.find(a.targetSelector).each(function(){var c=e(this);c.addClass("mix_all");a.origOrder.push(c)});!a.mixing&&"undefined"!==typeof d&&(e(a.filterSelector).removeClass("active"),e(a.filterSelector+'[data-filter="'+d+'"]').addClass("active"),v(d,null,null,g,a))})}};e.fn.mixitup=function(d,a){if(x[d])return x[d].apply(this,Array.prototype.slice.call(arguments,1));if("object"===
typeof d||!d)return x.init.apply(this,arguments)};e.fn.removeStyle=function(d){return this.each(function(){var a=e(this);d=d.replace(/\s+/g,"");var g=d.split(",");e.each(g,function(){var c=RegExp(this.toString()+"[^;]+;?","g");a.attr("style",function(b,a){if(a)return a.replace(c,"")})})})};Array.prototype.compare=function(d){if(this.length!=d.length)return!1;for(var a=0;a<d.length;a++)if(this[a].compare&&!this[a].compare(d[a])||this[a]!==d[a])return!1;return!0}})(jQuery);